<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="Programio" type="application/atom+xml"><link rel="icon" href="/images/favicon.png"><title>Jak vytvářím interní odkazy - Programio</title><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro"><link rel="stylesheet" href="/css/main.css" type="text/css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="head"><h1 class="head-title u-fl"> <a href="/">Programio</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/" class="head-nav__link">Domů</a></li><li class="head-nav__item"><a href="/archives" class="head-nav__link">Archiv</a></li><li class="head-nav__item"><a href="http://www.havrlant.cz/" class="head-nav__link">O autorovi</a></li><li class="head-nav__item"><a href="/rss.xml" class="head-nav__link">RSS</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2014-12-21T14:35:45.000Z" class="post__time">21. 12. 2014</time><h1 class="post__title"><a href="/jak-vytvarim-interni-odkazy/">Jak vytvářím interní odkazy</a></h1></header><div class="post__main echo"><p>Pokud píšete nějaký obsahově bohatý web, asi jste řešili, jak nějak rozumně zapisovat v kódu odkazy na ostatní interní stránky vašeho webu. Popíši způsob, který používám na svém webu <a href="http://www.matematika.cz/matematika-polopate" target="_blank" rel="external">matematika.cz</a>.</p>
<p>Představme si, že máme v textu nějakého článku větu <em>“A k tomu použijeme kvadratické rovnice.”</em> Pokud chceme uživatelům poskytnout větší komfort, bude sousloví <em>“kvadratické rovnice”</em> odkazem na odpovídající článek. Otázkou je, jak to nějak jednoduše zařídit. Podobných spojení je totiž ve většině článků hromada, takže čím jednodušším způsobem odkaz vyrobíme, tím lépe pro nás. A za tu dobu, po kterou podobné články píši už vím, že ta jednoduchost udělá hodně (aneb v současnosti jsem schopný napsat jeden článek odhadem za dva až třikrát kratší dobu než před osmi lety).</p>
<p>Popíšu fáze, kterými jsem prošel:</p>
<p>1) Prosté HTML. To je pro masochisty, protože abych vytvořil odkaz, musím zkrátka napsat <code>&lt;a href=&quot;/kvadraticke-rovnice&quot;&gt;kvadratické rovnice&lt;/a&gt;</code>. Nic složitějšího neexistuje.</p>
<p>2) Markdown zápis. Místo čistého HTML napíši <code>[kvadratické rovnice](/kvadarticke-rovnice)</code>. Je to kratší, je to čitelnější, chytřejší editory mi to dokonce nějak barevně zvýrazní a některé poloWYSIWYG editory mi z toho udělají reálný klikací odkaz. Ale pořád musím psát hromadu věcí ručně.</p>
<p>3) Pak jsem si vzpomněl, že taková Wikipedie umožňuje vytvořit jednoduše tím, že text, který má být odkazem, obalím do dvou závorek a systém z toho vytvoří odkaz sám. Tj. stačí napsat <code>[[kvadratické rovnice]]</code> a systém sám vytvoří odpovídající odkaz.</p>
<p>4)   Předchozí řešení zní jako svatý grál, jenže jsem rychle narazil. Většina spojení, ze kterých jsem chtěl udělat odkaz, nebyla v základním tvaru, ve kterém byl název článku. Co když by věta zněla <em>“A k tomu použijeme kvadratickou rovnici.”</em>? Pokud bych použil syntax <code>[[kvadratickou rovnici]]</code>, systém by mi vytvořil odkaz na špatný článek. Mohl jsem se tak u takových spojení buď vrátit k předchozí možnosti a vypisovat odkaz ručně … nebo jsem mohl vytvořit jednu velkou databázi, kde klíčem byl text odkazu a hodnotou adresa stránky. To jsem udělal, takže jsem měl jednu databázi, ve které jsem měl záznamy typu</p>
<pre><code><span class="escape">`k</span>vadratickou rovnici -&gt; /kvadraticke-rovnice<span class="escape">`
</span>
<span class="escape">`k</span>vadratická rovnice  -&gt; /kvadraticke-rovnice<span class="escape">`
</span>
<span class="escape">`.</span>..<span class="escape">`
</span>
<span class="literal">a</span> při parsování odkazu jsem se vždy podívat do tabulky, našel odpovídající záznam <span class="literal">a</span> vytvořil jsem správný odkaz. Výhodou bylo, že jsem každou kombinaci zapsal jen jednou na jedno centrální místo <span class="literal">a</span> pak už jsem v článcích mohl opakovaně použít syntaxi <span class="escape">`[</span>[kvadratickou rovnici]]<span class="escape">` </span><span class="literal">a</span> systém mi vygeneroval správný odkaz.
</code></pre><p>5) Předchozí řešení mě ale docela rychle přestalo bavit, protože jsem pořád dokola aktualizoval databázi s odkazy a to mě prudilo. Všiml jsem si, že text odkazu není stejný jako cíl odkazu, ale je velmi <em>podobný</em>. Napadlo mě tedy, že můžu vzít text odkazu a najít adresu článku, která je nejvíce podobná textu odkazu a na tento článek nasměrovat odkaz. Pokud napíši <code>[[kvadratickou rovnici]]</code>, tak by nemělo být těžké algoritmicky poznat, že chci odkázat na <code>/kvadraticke-rovnice</code> a ne na <code>/derivace</code>. Zbývalo už jen vymyslet implementaci.</p>
<pre><code><span class="keyword">Ta</span> byla kupodivu jednoduchá. Funkci, která <span class="keyword">d</span>ě<span class="keyword">l</span>á přesně takové porovná<span class="keyword">n</span>í, totiž většina z <span class="keyword">n</span>ás používá kaž<span class="keyword">d</span>ý den -- obsahuje ji kontrola pravopisu, která vá<span class="keyword">m</span> v případě překlepu nabízí, jaké slovo jste asi chtě<span class="keyword">li</span> napsat. V nejjednodušší <span class="keyword">form</span>ě algoritmus v první<span class="keyword">m</span> kroku rychle zjistí, ž<span class="keyword">e</span> toto slovo není ve slovníku zná<span class="keyword">m</span>ých slov a ve druhé<span class="keyword">m</span> kroku projde všechna slova a najde slovo, které je tomu nesprávnému nejpodobnější. To je přesně to, co jsem potřeboval.

Python ve standardní knihovně obsahuje funkci [difflib.get_close_matches](https:<span class="comment">//docs.python.org/2/library/difflib.html#difflib.get_close_matches), která dělá přesně to, co jsem potřeboval. Předáte jí seznam známých slov (v mém případě seznam existujících článků na Matematice) a slovo (v mém případě text odkazu). Funkce vám vrátí ze seznamu slov to, které je předanému slovu nejbližší. V mém případě by pro slovo *"kvadratickou rovnici"*  vrátila funkce adresu *"/kvadarticke-rovnice"*.</span>

Toto ř<span class="keyword">e</span>š<span class="keyword">en</span>í doteď používá<span class="keyword">m</span> a je extrémně efektivní. Ve chví<span class="keyword">li</span>, kdy chci vytvořit z <span class="keyword">n</span>ějakého spojení odkaz, zkrátka ho jen obalí<span class="keyword">m</span> `[[...]]` a v drtivé větš<span class="keyword">in</span>ě případů <span class="keyword">se</span> vytvoří odkaz na č<span class="keyword">l</span>ánek, na který jsem chtě<span class="keyword">l</span> odkaz. Ve zbytku případů buď napíš<span class="keyword">u</span> odkaz <span class="keyword">ru</span>č<span class="keyword">n</span>ě anebo přidá<span class="keyword">m</span> záznam <span class="keyword">do</span> tabulky odkazů (kterou jsem si ponechal).

Hledá<span class="keyword">n</span>í odkazů samozřejmě prová<span class="keyword">d</span>í<span class="keyword">m</span> ve fázi preprocessingu, na serveru <span class="keyword">u</span>ž <span class="keyword">se</span> nic neprohledává.
</code></pre><p>6) Chvíli jsem koketoval s myšlenkou vytvářet ty odkazy zcela automaticky. Tj., že bych napsal skript, který projde text článku a v něm sám najde spojení, ze kterých by šel udělat odkaz na jiný článek. Například by vzal všechny po sobě jdoucí dvojice slov a pokud by našel článek, jehož název se s dvojicí slov shoduje v nějaké vysoké míře (90 % apod.), tak z tohoto spojení udělá odkaz na zmíněný článek. Asi už by to nebylo úplně jednoduché, musel bych pořešit, aby v článku nebylo deset odkazů na stejný článek (to už spíš otravuje), případně aby v jednom odstavci nebylo deset odkazů a ve druhém žádný. Zkrátka nejspíš by z toho bylo víc problémů, než kolik by to přineslo užitku. Zatím tak zůstávám u pátého řešení.</p>
<pre><code>Nicmé<span class="keyword">n</span>ě <span class="keyword">st</span>ále <span class="keyword">m</span>á<span class="keyword">m</span> toto ř<span class="keyword">e</span>š<span class="keyword">en</span>í na paměti, protož<span class="keyword">e</span> kromě zjevné výhody, ž<span class="keyword">e</span> nemusí<span class="keyword">m</span> <span class="keyword">ru</span>č<span class="keyword">n</span>ě označovat odkazy, <span class="keyword">m</span>á ještě jednu výhodu: pokud napíši č<span class="keyword">l</span>ánek o derivacích, ve kterých zmí<span class="keyword">n</span>í<span class="keyword">m</span> slovo *<span class="string">"integrál"</span>* a č<span class="keyword">l</span>ánek o integrálech napíši až o <span class="keyword">m</span>ěsíc později, tak stačí o ten <span class="keyword">m</span>ěsíc později č<span class="keyword">l</span>ánek o derivacích přeformátovat a rázem <span class="keyword">m</span>á<span class="keyword">m</span> ze slova *<span class="string">"integrál"</span>* odkaz na nový č<span class="keyword">l</span>ánek, aniž bych v č<span class="keyword">l</span>ánku o derivacích cokoliv změnil. Samozřejmě takto mohu po publikaci nového č<span class="keyword">l</span>ánku projet všechny č<span class="keyword">l</span>ánky, které na webu <span class="keyword">m</span>á<span class="keyword">m</span>. Nevýhodou je, ž<span class="keyword">e</span> tvorbu odkazů nemá<span class="keyword">te</span> vůbec pod kontrolou -- jednou zkontrolujete, jestli <span class="keyword">se</span> odkazy vytvořily správně, ale o týden později <span class="keyword">u</span>ž <span class="keyword">m</span>ůž<span class="keyword">e</span> být vš<span class="keyword">e</span> jinak. 
</code></pre><p>Popsané páté řešení určitě není pro každého, protože ne vždy je v textu tak silná podobnost mezi textem odkazu a cílem odkazu, ale pokud už nějaký takový web máte, můžete to také vyzkoušet. Je to silně návykové 8-)</p>
<!-- p="A jestli vás článek opravdu zaujal, "--><!--  a(href="http://www.ibillboard.com/cs/spolecnost/spolecnost/kariera/202-vyvojar-nodejs-javascript")="tak pojďte pracovat k nám do firmy!"--><!--  =" Podobných problémů řešíme mraky." -->
</div></article><div style="text-align: right"><div class="fb-like" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true" style="margin-top: 10px; height: 30px"></div></div><div class="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div><footer class="post__foot u-cf"><a href="/jak-vytvarim-interni-odkazy/#disqus_thread" class="post__foot-link u-fr">Komentáře</a></footer></main><footer class="foot"><div class="foot-copy u-fl"><a href="/">Programio</a> píše <a href="http://www.havrlant.cz/">Lukáš Havrlant</a></div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/sjednoceni-hyperloglogu/" class="page-menu__link icon-arrow-left"></a></li><li class="page-menu__item"><a title="Next" href="/hyperloglog/" class="page-menu__link icon-arrow-right"></a></li></menu></footer><script>(function(h,g,l,k,j,i){j=h.createElement(g),i=h.getElementsByTagName(g)[0],
j.src="//"+l+".disqus.com/"+k+".js",i.parentNode.insertBefore(j,i)})
(document,"script","programio","embed");
</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
e=o.createElement(i);r=o.getElementsByTagName(i)[0];
e.src='//www.google-analytics.com/analytics.js';
r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-1559810-13');ga('send','pageview');
</script><div id="fb-root"></div><script>(function(d, s, id) {
var js, fjs = d.getElementsByTagName(s)[0];
if (d.getElementById(id)) return;
js = d.createElement(s); js.id = id;
js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=166268190106534&version=v2.0";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script></body></html>