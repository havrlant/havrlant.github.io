<!DOCTYPE html><html><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="alternative" href="/atom.xml" title="Programio" type="application/atom+xml"><link rel="icon" href="/images/favicon.png"><title>Jak vytvářím interní odkazy - Programio</title><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro"><link rel="stylesheet" href="/css/main.css" type="text/css"><!--[if lt IE 9]><script>(function(a,b){a="abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video".split(" ");for(b=a.length-1;b>=0;b--)document.createElement(a[b])})()</script><![endif]--></head><body><header class="head"><h1 class="head-title u-fl"> <a href="/">Programio</a></h1><nav class="head-nav u-fr"><ul class="head-nav__list"><li class="head-nav__item"><a href="/" class="head-nav__link">Domů</a></li><li class="head-nav__item"><a href="/archives" class="head-nav__link">Archiv</a></li><li class="head-nav__item"><a href="http://www.havrlant.cz/" class="head-nav__link">O autorovi</a></li><li class="head-nav__item"><a href="/rss.xml" class="head-nav__link">RSS</a></li></ul></nav></header><main class="main"><article class="post"><header class="post__head"><time datetime="2014-12-21T14:35:45.000Z" class="post__time">21. 12. 2014</time><h1 class="post__title"><a href="/jak-vytvarim-interni-odkazy/">Jak vytvářím interní odkazy</a></h1></header><div class="post__main echo"><p>Pokud píšete nějaký obsahově bohatý web, asi jste řešili, jak nějak rozumně zapisovat v kódu odkazy na ostatní interní stránky vašeho webu. Popíši způsob, který používám na svém webu <a href="http://www.matematika.cz/matematika-polopate" target="_blank" rel="external">matematika.cz</a>.</p>
<p>Představme si, že máme v textu nějakého článku větu <em>“A k tomu použijeme kvadratické rovnice.”</em> Pokud chceme uživatelům poskytnout větší komfort, bude sousloví <em>“kvadratické rovnice”</em> odkazem na odpovídající článek. Otázkou je, jak to nějak jednoduše zařídit. Podobných spojení je totiž ve většině článků hromada, takže čím jednodušším způsobem odkaz vyrobíme, tím lépe pro nás. A za tu dobu, po kterou podobné články píši už vím, že ta jednoduchost udělá hodně (aneb v současnosti jsem schopný napsat jeden článek odhadem za dva až třikrát kratší dobu než před osmi lety).</p>
<p>Popíšu fáze, kterými jsem prošel:</p>
<ol style="list-style-type: decimal">
<li><p>Prosté HTML. To je pro masochisty, protože abych vytvořil odkaz, musím zkrátka napsat <code>&lt;a href=&quot;/kvadraticke-rovnice&quot;&gt;kvadratické rovnice&lt;/a&gt;</code>. Nic složitějšího neexistuje.</p></li>
<li><p>Markdown zápis. Místo čistého HTML napíši <code>[kvadratické rovnice](/kvadarticke-rovnice)</code>. Je to kratší, je to čitelnější, chytřejší editory mi to dokonce nějak barevně zvýrazní a některé poloWYSIWYG editory mi z toho udělají reálný klikací odkaz. Ale pořád musím psát hromadu věcí ručně.</p></li>
<li><p>Pak jsem si vzpomněl, že taková Wikipedie umožňuje vytvořit jednoduše tím, že text, který má být odkazem, obalím do dvou závorek a systém z toho vytvoří odkaz sám. Tj. stačí napsat <code>[[kvadratické rovnice]]</code> a systém sám vytvoří odpovídající odkaz.</p></li>
<li><p>Předchozí řešení zní jako svatý grál, jenže jsem rychle narazil. Většina spojení, ze kterých jsem chtěl udělat odkaz, nebyla v základním tvaru, ve kterém byl název článku. Co když by věta zněla <em>“A k tomu použijeme kvadratickou rovnici.”</em>? Pokud bych použil syntax <code>[[kvadratickou rovnici]]</code>, systém by mi vytvořil odkaz na špatný článek. Mohl jsem se tak u takových spojení buď vrátit k předchozí možnosti a vypisovat odkaz ručně … nebo jsem mohl vytvořit jednu velkou databázi, kde klíčem byl text odkazu a hodnotou adresa stránky. To jsem udělal, takže jsem měl jednu databázi, ve které jsem měl záznamy typu</p>
<p><code>kvadratickou rovnici -&gt; /kvadraticke-rovnice</code></p>
<p><code>kvadratická rovnice  -&gt; /kvadraticke-rovnice</code></p>
<p><code>...</code></p>
<p>a při parsování odkazu jsem se vždy podívat do tabulky, našel odpovídající záznam a vytvořil jsem správný odkaz. Výhodou bylo, že jsem každou kombinaci zapsal jen jednou na jedno centrální místo a pak už jsem v článcích mohl opakovaně použít syntaxi <code>[[kvadratickou rovnici]]</code> a systém mi vygeneroval správný odkaz.</p></li>
<li><p>Předchozí řešení mě ale docela rychle přestalo bavit, protože jsem pořád dokola aktualizoval databázi s odkazy a to mě prudilo. Všiml jsem si, že text odkazu není stejný jako cíl odkazu, ale je velmi <em>podobný</em>. Napadlo mě tedy, že můžu vzít text odkazu a najít adresu článku, která je nejvíce podobná textu odkazu a na tento článek nasměrovat odkaz. Pokud napíši <code>[[kvadratickou rovnici]]</code>, tak by nemělo být těžké algoritmicky poznat, že chci odkázat na <code>/kvadraticke-rovnice</code> a ne na <code>/derivace</code>. Zbývalo už jen vymyslet implementaci.</p>
<p>Ta byla kupodivu jednoduchá. Funkci, která dělá přesně takové porovnání, totiž většina z nás používá každý den – obsahuje ji kontrola pravopisu, která vám v případě překlepu nabízí, jaké slovo jste asi chtěli napsat. V nejjednodušší formě algoritmus v prvním kroku rychle zjistí, že toto slovo není ve slovníku známých slov a ve druhém kroku projde všechna slova a najde slovo, které je tomu nesprávnému nejpodobnější. To je přesně to, co jsem potřeboval.</p>
<p>Python ve standardní knihovně obsahuje funkci <a href="https://docs.python.org/2/library/difflib.html#difflib.get_close_matches" target="_blank" rel="external">difflib.get_close_matches</a>, která dělá přesně to, co jsem potřeboval. Předáte jí seznam známých slov (v mém případě seznam existujících článků na Matematice) a slovo (v mém případě text odkazu). Funkce vám vrátí ze seznamu slov to, které je předanému slovu nejbližší. V mém případě by pro slovo <em>“kvadratickou rovnici”</em> vrátila funkce adresu <em>“/kvadarticke-rovnice”</em>.</p>
<p>Toto řešení doteď používám a je extrémně efektivní. Ve chvíli, kdy chci vytvořit z nějakého spojení odkaz, zkrátka ho jen obalím <code>[[...]]</code> a v drtivé většině případů se vytvoří odkaz na článek, na který jsem chtěl odkaz. Ve zbytku případů buď napíšu odkaz ručně anebo přidám záznam do tabulky odkazů (kterou jsem si ponechal).</p>
<p>Hledání odkazů samozřejmě provádím ve fázi preprocessingu, na serveru už se nic neprohledává.</p></li>
<li><p>Chvíli jsem koketoval s myšlenkou vytvářet ty odkazy zcela automaticky. Tj., že bych napsal skript, který projde text článku a v něm sám najde spojení, ze kterých by šel udělat odkaz na jiný článek. Například by vzal všechny po sobě jdoucí dvojice slov a pokud by našel článek, jehož název se s dvojicí slov shoduje v nějaké vysoké míře (90 % apod.), tak z tohoto spojení udělá odkaz na zmíněný článek. Asi už by to nebylo úplně jednoduché, musel bych pořešit, aby v článku nebylo deset odkazů na stejný článek (to už spíš otravuje), případně aby v jednom odstavci nebylo deset odkazů a ve druhém žádný. Zkrátka nejspíš by z toho bylo víc problémů, než kolik by to přineslo užitku. Zatím tak zůstávám u pátého řešení.</p>
<p>Nicméně stále mám toto řešení na paměti, protože kromě zjevné výhody, že nemusím ručně označovat odkazy, má ještě jednu výhodu: pokud napíši článek o derivacích, ve kterých zmíním slovo <em>“integrál”</em> a článek o integrálech napíši až o měsíc později, tak stačí o ten měsíc později článek o derivacích přeformátovat a rázem mám ze slova <em>“integrál”</em> odkaz na nový článek, aniž bych v článku o derivacích cokoliv změnil. Samozřejmě takto mohu po publikaci nového článku projet všechny články, které na webu mám. Nevýhodou je, že tvorbu odkazů nemáte vůbec pod kontrolou – jednou zkontrolujete, jestli se odkazy vytvořily správně, ale o týden později už může být vše jinak.</p></li>
</ol>
<p>Popsané páté řešení určitě není pro každého, protože ne vždy je v textu tak silná podobnost mezi textem odkazu a cílem odkazu, ale pokud už nějaký takový web máte, můžete to také vyzkoušet. Je to silně návykové 8-)</p>
<p>A jestli vás článek opravdu zaujal, <a href="http://www.ibillboard.com/cs/spolecnost/spolecnost/kariera/202-vyvojar-nodejs-javascript">tak pojďte pracovat k nám do firmy!</a> Podobných problémů řešíme mraky.</p></div></article><div style="text-align: right"><div class="fb-like" data-layout="button_count" data-action="like" data-show-faces="true" data-share="true" style="margin-top: 10px; height: 30px"></div></div><div class="comments"><div id="disqus_thread"><noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></div></div><footer class="post__foot u-cf"><a href="/jak-vytvarim-interni-odkazy/#disqus_thread" class="post__foot-link u-fr">Komentáře</a></footer></main><footer class="foot"><div class="foot-copy u-fl"><a href="/">Programio</a> píše <a href="http://www.havrlant.cz/">Lukáš Havrlant</a></div><menu class="page-menu u-fr"><li class="page-menu__item"><a title="Previous" href="/sjednoceni-hyperloglogu/" class="page-menu__link icon-arrow-left"></a></li><li class="page-menu__item"><a title="Next" href="/hyperloglog/" class="page-menu__link icon-arrow-right"></a></li></menu></footer><script>(function(h,g,l,k,j,i){j=h.createElement(g),i=h.getElementsByTagName(g)[0],
j.src="//"+l+".disqus.com/"+k+".js",i.parentNode.insertBefore(j,i)})
(document,"script","programio","embed");
</script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
e=o.createElement(i);r=o.getElementsByTagName(i)[0];
e.src='//www.google-analytics.com/analytics.js';
r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
ga('create','UA-1559810-13');ga('send','pageview');
</script><div id="fb-root"></div><script>(function(d, s, id) {
var js, fjs = d.getElementsByTagName(s)[0];
if (d.getElementById(id)) return;
js = d.createElement(s); js.id = id;
js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&appId=166268190106534&version=v2.0";
fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script></body></html>